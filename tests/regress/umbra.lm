
import LIB/default.lm;

main := Î». (: (
   # test short string
   (let a (to-umbra(CHey_s)))
   (set a (clone(a)))
   (set a (+(a C!_s)))
   (let hash (deep-hash(a)))
   (if (!=(a CHey!_s)) (
      (exit(C1_u32))
   ) ())
   (if (==(a CHey_s)) (
      (exit(C2_u32))
   ) ())
   (if (not (.has-prefix(a CHe_s))) (
      (exit(C3_u32))
   ) ())
   (print(a))

   # test long string
   (set a (to-umbra(Cabcdefghijklmnopqrstuvwxy_s)))
   (set a (clone(a)))
   (set a (+(a Cz_s)))
   (set hash (deep-hash(a)))
   (if (!=(a Cabcdefghijklmnopqrstuvwxyz_s)) (
      (exit(C4_u32))
   ) ())
   (if (==(a Cabcd_s)) (
      (exit(C5_u32))
   ) ())
   (if (not (.has-prefix(a Cabc_s))) (
      (exit(C6_u32))
   ) ())
   (print(a))
) Nil);
